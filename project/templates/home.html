<html  lang="en">
<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>Home</title>
    <link href="{{ url_for('static', filename='../statics/css/bootstrap/bootstrap.css') }} " rel="stylesheet" />
    <link href="{{ url_for('static', filename='../statics/css/bootstrap/bootstrap-theme.css') }} " rel="stylesheet" />
        <link href="{{ url_for('static', filename='../statics/css/sweetalert.css') }} " rel="stylesheet" />
    <script src="{{ url_for('static', filename='../statics/js/sweetalert.min.js') }}" /></script>
    <script src="{{ url_for('static', filename='../statics/js/jquery-2.1.3.js') }}" /></script>
    <script src="{{ url_for('static', filename='../statics/js/bootstrap/bootstrap.js') }}" /></script>
	<script src="{{ url_for('static', filename='../statics/js/jquery.nicescroll.min.js') }}" /></script>	
    <link href="{{ url_for('static', filename='../statics/css/style.css') }}" rel="stylesheet" />
<link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    
   
</head>

<body>
	<ul class=" col-xs-3 col-md-2 leftmenu shadow " id="leftmenu" >
		
		<li class=" usernameitem " id="usernameitem">
			<a href="#"><h4 id="getusername" class="leftmenuitem"></h4></a>
			<a ><h4 id="getidprof" class="leftmenuitem" style="display:none"></h4></a>
		</li>	
		
		
		<li  id="contest"  >
		 	<a href="#"><h4 class="leftmenuitem"><i  class="fa fa-laptop" style="width:20px; height:20px;"> </i> Contests</h4></a>
		</li>
		
		<li  id="team"  >
		 	<a href="#"><h4 class="leftmenuitem"><i class="fa fa-group" style=" width:20px; height:20px; "></i> Teams</h4></a>
		</li>
		
		<li  id="users"  style="display:none" >
		 	<a href="#"><h4 class="leftmenuitem"><i class="fa fa-user" style="width:20px; height:20px; "></i> Users</h4></a>
		</li>
		
		<li  id="setting"  >
		 	<a href="/user/setting/"><h4 class="leftmenuitem"><i class="fa fa-gears" style=" width:20px; height:20px; "></i> Settings</h4></a>
		</li>
		<li  id="backtoprofile" style="display:none" >
		 	<a href="#" ><h4 class="leftmenuitem"><i class="fa fa-mail-reply"style=" width:20px; height:20px; "></i>Back to profile</h4></a>
		</li>
		
		<li  id="logout"   >
		 	<a href="#"><h4 class="leftmenuitem"><i class="fa fa-sign-out" style=" width:20px; height:20px; "></i> Log out</h4></a>
		</li>
		</ul>

    <div class="col-xs-offset-3 col-md-offset-2 row">
		<div class="col-xs-12 col-md-12 maintitr">
			<p id="titlePage"> Contest list</p>          
		</div>
	</div>
	<div class="col-xs-offset-3 col-md-offset-2 row">
      	<div id="contents" class="contents " >
			<div id="contestinfoforusers"class="CSSTableGenerator" >							
				<table id="contestinfo">
                   <tr>
					   <td > Row number </td>
					   <td style="display:none"> id </td>
					   <td > Name </td>
					   <td > Admin </td>
					   <td style="display:none"> Admin id </td>
					   <td > Sart on </td>
					    <td> End on </td>
					    <td > Your team</td>
					</tr>
                </table>
             </div>
		
			<div id="info"></div>
			</div>
   	</div>
   

</body>
<script>
	$(document).ready(function () {
	     var id = '{{user_id }}'; 
	     var username=null;
	 //change profile
function changeprofile(username){
		document.title = username;
			document.getElementById('backtoprofile').style.display = 'block';
			$('#info').show(1000);

			document.getElementById('logout').style.display = 'none';
			document.getElementById('users').style.display = 'none';
			document.getElementById('setting').style.display = 'none';
			document.getElementById('contestinfoforusers').style.display = 'none';
			document.getElementById('titlePage').innerHTML="Information" ;		
					 
}
function checkprofile(username){
		 $.ajax({
            type: "GET",
            url : '/user/get_profile/',
            dataType: "html", 				
            success: function (data) {
				var userlogin=(JSON.parse(data)).username;
           if(username===userlogin){
           document.getElementById('info').style.display = 'none';	}
           else{
			   
			  changeprofile(username);
			   
			   }				
            },
           error: function (request) {                
				swal("Sorry!", (JSON.parse(request.responseText)).errors, "error") ;     	      		
      		}
		});
	}
	
	//show username
	
     $.ajax({
            type: "GET",
            url : "/user/get_profile/by_id/"+id+"/",
            dataType: "html", 				
            success: function (data) {
				$('#info').html(data);
			 username=(JSON.parse(data)).username;
				checkprofile(username);
				$( '#getusername ' ).html(username);
				$( '#getidprof ' ).html(id);  
				$('#info').html(data);	
					
            },
           error: function (request) {                
				swal("Sorry!", (JSON.parse(request.responseText)).errors, "error") ;      	      		
      		}
		});
$("#getusername").click(function() {
			window.location.replace("/user/"+username+"/");
		});
	// back to profile
$("#backtoprofile").click(function() { 
	 $.ajax({
            type: "GET",
            url : '/user/get_profile/',
            dataType: "html", 				
            success: function (data) {
				var userlogin=(JSON.parse(data)).username; 
				window.location.replace("/user/"+userlogin+"/");         				
            },
           error: function (request) {                
				swal("Sorry!", (JSON.parse(request.responseText)).errors, "error") ;      	      		
      		}
		});
           	
              document.title = "home";
			document.getElementById('usernameitem').style.display = 'block';
			document.getElementById('usernameprofitem').style.display = 'none';
			document.getElementById('backtoprofile').style.display = 'none';
			document.getElementById('logout').style.display = 'block';
			document.getElementById('users').style.display = 'block';
			document.getElementById('setting').style.display = 'block';
			  });
			   
//show contest list
 $.ajax({
            type: "GET",
            url : "/contest/",
            dataType: "html", 				
            success: function (data) {
				
           	var data=(JSON.parse(data)).contests;
				 var tr;
			for (var i = 1; i < data.length+1; i++) {
				tr = $('<tr id="'+i+'">');
				tr.append('<td >' + i + "</td>");
				tr.append('<td style="display:none">' + data[i-1].id + "</td>");
				tr.append('<td>' + data[i-1].name + "</td>");			
				tr.append('<td >' + data[i-1].owner.username + "</td>");
				tr.append('<td style="display:none">' + data[i-1].owner.id + "</td>");
				tr.append('<td>' + data[i-1].starts_on + "</td>");
				tr.append('<td >' + data[i-1].ends_on + "</td></tr>");
				
				$('#contestinfo').append(tr);
			
			}
				$('td').click(function(){
					id = $(this).closest('tr').attr('id');
					window.location.replace("/contest/"+data[id-1].name+"/");
					
				});				
            },
           error: function (request) {                
				swal("Sorry!", (JSON.parse(request.responseText)).errors, "error"); 	      	      		
      		}
		});	
		
//logout
$("#logout").click(function() { 
	
  $.ajax({
            type: "GET",
            url : '/user/logout/',
            dataType: "html",  				
            success: function () {
           	window.location.replace("/user/");
            },
          error: function (request, status, error) { 
			  window.location.replace("/user/");           
            }
            
    });
  });
 
// back to profile
$("#backtoprofile").click(function() { 
	 $.ajax({
            type: "GET",
            url : '/user/get_profile/',
            dataType: "html", 				
            success: function (data) {
				var userlogin=(JSON.parse(data)).username; 
				window.location.replace("/user/"+userlogin+"/");         				
            },
           error: function (request) {                
				window.location.replace("/user/");  	      	      		
      		}
		});
		});

      //contest of user
$("#contest").click(function() { 
	window.location.replace("/user/"+username+"/contest/");
  });
$("#team").click(function() {
	window.location.replace("/user/"+username+"/team/");
  });
  });
  
  $(document).ready(function() {
    $("html").niceScroll({cursorwidth: '10px', autohidemode:true, zindex: 999 });
});
	</script>

</html>

